# Library Manager (GORM + Gen)

A minimal scaffold for a **Library Manager** project built with Go, [GORM](https://gorm.io) and [gorm.io/gen](https://gorm.io/gen) to showcase type-safe SQL queries using GORM.

## Requirements

- Go 1.24+
- PostgreSQL
- [Atlas](https://atlasgo.dev/) (for migrations)

## Getting started

```bash
git clone https://github.com/danielmesquitta/library-manager.git
cd library-manager

# Copy environment and configure DB credentials
cp .env.example .env

# Install dependencies
make install
```

Make sure to set the `DATABASE_URL` in the `.env` file to point to your PostgreSQL database.

### 1. Run migrations

```bash
make migrate
```

### 2. Generate type‑safe query code

```bash
make generate
```

Generated code will appear in the `query` directory.

### 3. Run the application

```bash
make run
```

## Project layout

```
.
├── cmd               # Entrypoints (run, gen)
├── internal
│   ├── database      # DB connection helper
│   └── model         # GORM models
│   └── query         # Generated by gorm.io/gen (DO NOT EDIT)
├── go.mod
├── atlas.hcl         # Atlas migration configuration
├── Makefile          # Makefile for scripts
├── README.md
└── tools.go          # Tools for generating code
```

## Makefile commands

- `make install` - Download Go module dependencies
- `make update` - Update Go modules and tidy dependencies
- `make run` - Run the application
- `make generate` - Generate type-safe query code using gorm.io/gen
- `make create_migration <name>` - Create a new migration with the specified name
- `make create_blank_migration <name>` - Create a blank migration with the specified name
- `make migrate` - Apply all pending migrations
- `make migrate_down <version>` - Roll back migrations to the specified version
